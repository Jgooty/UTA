
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ulcer Symptom Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: canvas; color: canvastext;
	
            transition: background 0.3s, color 0.3s;
        }
        @media (prefers-color-scheme: dark) { body { background: black; color: white; } }
        .container { max-width: 600px; margin: 0 auto; }
        .tabs { display: flex; background: #f0f0f0; border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
        @media (prefers-color-scheme: dark) { .tabs { background: #333; } }
        .tab-btn { flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-size: 16px; transition: background 0.2s; }
        .tab-btn.active { background: #007AFF; color: white; }
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        @media (prefers-color-scheme: dark) { input, select, textarea { background: #444; color: white; border-color: #666; } }
        button { background: #007AFF; color: white; border: none; padding: 15px; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; width: 100%; margin: 10px 0; }
        button:hover { background: #0056CC; }
        .log-entry { background: white; margin: 10px 0; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        @media (prefers-color-scheme: dark) { .log-entry { background: #444; } }
        .delete-btn { background: #FF3B30; font-size: 14px; padding: 8px 12px; width: auto; margin-left: auto; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        @media (prefers-color-scheme: dark) { .stat-card { background: #444; } }
        .symptoms-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 8px; }
        .symptom-checkbox { padding: 10px; border: 2px solid #ddd; border-radius: 8px; text-align: center; cursor: pointer; }
        .symptom-checkbox.checked { background: #007AFF; color: white; border-color: #007AFF; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ©º Ulcer Symptom Tracker</h1>
        <p>Log symptoms, foods, meds. Track patterns. Export for doctor.</p>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('log')">Log Entry</button>
            <button class="tab-btn" onclick="showTab('history')">History</button>
            <button class="tab-btn" onclick="showTab('stats')">Stats</button>
        </div>

        <div id="log" class="tab-content active">
            <form id="logForm">
                <label>Date: <input type="date" id="date" required></label>
                <label>Time: <input type="time" id="time" required></label>
                <label>Pain (1-10): <input type="range" id="pain" min="1" max="10" value="5"> <span id="painValue">5</span></label>
                <div>Symptoms:</div>
                <div class="symptoms-grid">
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'burning')">Burning</label>
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'bloating')">Bloating</label>
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'nausea')">Nausea</label>
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'burping')">Burping</label>
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'vomiting')">Vomiting</label>
                    <label class="symptom-checkbox" onclick="toggleSymptom(this,'bloody_stool')">Bloody Stool</label>
                </div>
                <label>Foods/Drinks: <input type="text" id="foods" placeholder="e.g. banana, coffee"></label>
                <label>Meds Taken: <input type="text" id="meds" placeholder="e.g. Prilosec, antacid"></label>
                <label>Notes: <textarea id="notes" rows="3" placeholder="e.g. pain worsened after banana"></textarea></label>
                <button type="submit">Save Log</button>
            </form>
        </div>

        <div id="history" class="tab-content">
            <div id="historyList">No entries yet. Log something!</div>
            <button onclick="loadHistory()">Refresh History</button>
        </div>

        <div id="stats" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalEntries">0</h3>
                    <div>Total Logs</div>
                </div>
                <div class="stat-card">
                    <h3 id="avgPain">--</h3>
                    <div>Avg Pain</div>
                </div>
                <div class="stat-card">
                    <h3 id="maxPain">--</h3>
                    <div>Max Pain</div>
                </div>
                <div class="stat-card">
                    <h3 id="topSymptom">--</h3>
                    <div>Most Common Symptom</div>
                </div>
            </div>
            <button onclick="exportCSV()">ðŸ“¥ Export CSV</button>
        </div>
    </div>

    <script>
        let entries = JSON.parse(localStorage.getItem('ulcerTracker') || '[]');

        // Auto-set date/time
        document.getElementById('date').valueAsDate = new Date();
        document.getElementById('time').value = new Date().toTimeString().slice(0,5);

        document.getElementById('pain').oninput = function() {
            document.getElementById('painValue').textContent = this.value;
        }

        document.getElementById('logForm').onsubmit = function(e) {
            e.preventDefault();
            const entry = {
                id: Date.now(),
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                pain: parseInt(document.getElementById('pain').value),
                symptoms: Array.from(document.querySelectorAll('.symptom-checkbox.checked')).map(cb => cb.textContent.trim().toLowerCase().replace(/\s+/g, '_')),
                foods: document.getElementById('foods').value,
                meds: document.getElementById('meds').value,
                notes: document.getElementById('notes').value
            };
            entries.unshift(entry);
            localStorage.setItem('ulcerTracker', JSON.stringify(entries));
            alert('âœ… Log saved! Check History tab.');
            this.reset();
            document.getElementById('date').valueAsDate = new Date();
            document.getElementById('time').value = new Date().toTimeString().slice(0,5);
            document.getElementById('pain').value = 5;
            document.getElementById('painValue').textContent = 5;
            showTab('history');
        }

        function toggleSymptom(cb, symptom) {
            cb.classList.toggle('checked');
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            if (tabName === 'history') loadHistory();
            if (tabName === 'stats') updateStats();
        }

        function loadHistory() {
            const list = document.getElementById('historyList');
            if (entries.length === 0) {
                list.innerHTML = '<p>No entries yet. Log something!</p>';
                return;
            }
            list.innerHTML = entries.map(entry => `
                <div class="log-entry">
                    <div><strong>${entry.date} ${entry.time}</strong> | Pain: ${entry.pain}/10</div>
                    ${entry.symptoms.length ? `<div>Symptoms: ${entry.symptoms.join(', ')}</div>` : ''}
                    ${entry.foods ? `<div>Foods: ${entry.foods}</div>` : ''}
                    ${entry.meds ? `<div>Meds: ${entry.meds}</div>` : ''}
                    ${entry.notes ? `<div>Notes: ${entry.notes}</div>` : ''}
                    <button class="delete-btn" onclick="deleteEntry(${entry.id})">Delete</button>
                </div>
            `).join('');
        }

        function deleteEntry(id) {
            entries = entries.filter(e => e.id !== id);
            localStorage.setItem('ulcerTracker', JSON.stringify(entries));
            loadHistory();
        }

        function updateStats() {
            if (entries.length === 0) return;
            const pains = entries.map(e => e.pain);
            document.getElementById('totalEntries').textContent = entries.length;
            document.getElementById('avgPain').textContent = Math.round(pains.reduce((a,b)=>a+b)/pains.length);
            document.getElementById('maxPain').textContent = Math.max(...pains);

            const symptomCounts = {};
            entries.forEach(e => e.symptoms.forEach(s => symptomCounts[s] = (symptomCounts[s] || 0) + 1));
            const topSymptom = Object.entries(symptomCounts).reduce((a,b) => b[1] > a[1] ? b : a, ['',0])[0];
            document.getElementById('topSymptom').textContent = topSymptom || 'None';
        }

        function exportCSV() {
            if (entries.length === 0) { alert('No data to export'); return; }
            let csv = 'Date,Time,Pain,Symptoms,Foods,Meds,Notes\n';
            entries.forEach(e => {
                csv += `"${e.date}","${e.time}",${e.pain},"${e.symptoms.join('; ')}","${e.foods}","${e.meds}","${e.notes}"\n`;
            });
            const blob = new Blob([csv], {type: 'text/csv'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ulcer_tracker.csv';
            a.click();
        }

        // Load on start
        loadHistory();
        updateStats();
    </script>
</body>
</html>
